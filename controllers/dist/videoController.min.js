"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteVideo=exports.postEditVideo=exports.getEditVideo=exports.videoDetail=exports.postUpload=exports.getUpload=exports.search=exports.home=void 0;var _routes=_interopRequireDefault(require("../routers/routes")),_Video=_interopRequireDefault(require("../models/Video"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var home=function(e,t){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(_Video.default.find({}));case 3:r=e.sent,t.render("home",{pageTitle:"Home",videos:r}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),t.render("home",{pageTitle:"Home",videos:[]});case 11:case"end":return e.stop()}},null,null,[[0,7]])};exports.home=home;var search=function(t,r){var n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query.term,o=[],e.prev=2,e.next=5,regeneratorRuntime.awrap(_Video.default.find({title:{$regex:n,$options:"i"}}));case 5:o=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:r.render("search",{pageTitle:"Search",searchingBy:n,videos:o});case 12:case"end":return e.stop()}},null,null,[[2,8]])};exports.search=search;var getUpload=function(e,t){return t.render("upload",{pageTitle:"Upload"})};exports.getUpload=getUpload;var postUpload=function(t,r){var n,o,a,i,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.body,o=n.title,a=n.description,i=t.file.path,e.next=3,regeneratorRuntime.awrap(_Video.default.create({fileUrl:i,title:o,description:a}));case 3:s=e.sent,r.redirect(_routes.default.videoDetail(s.id));case 5:case"end":return e.stop()}})};exports.postUpload=postUpload;var videoDetail=function(t,r){var n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.id,e.prev=1,e.next=4,regeneratorRuntime.awrap(_Video.default.findById(n));case 4:o=e.sent,r.render("videoDetail",{pageTitle:"Video Detail",video:o}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r.redirect(_routes.default.home);case 11:case"end":return e.stop()}},null,null,[[1,8]])};exports.videoDetail=videoDetail;var getEditVideo=function(t,r){var n,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.id,e.prev=1,e.next=4,regeneratorRuntime.awrap(_Video.default.findById(n));case 4:o=e.sent,r.render("editVideo",{pageTitle:"Edit ".concat(o.title),video:o}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),r.redirect(_routes.default.home);case 11:case"end":return e.stop()}},null,null,[[1,8]])};exports.getEditVideo=getEditVideo;var postEditVideo=function(t,r){var n,o,a,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.id,o=t.body,a=o.title,i=o.description,e.prev=1,e.next=4,regeneratorRuntime.awrap(_Video.default.findOneAndUpdate({_id:n},{title:a,description:i}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),r.redirect(_routes.default.home);case 9:case"end":return e.stop()}},null,null,[[1,6]])};exports.postEditVideo=postEditVideo;var deleteVideo=function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.id,e.prev=1,e.next=4,regeneratorRuntime.awrap(_Video.default.findOneAndRemove({_id:n}));case 4:r.redirect(_routes.default.home),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0),r.redirect(_routes.default.home);case 11:case"end":return e.stop()}},null,null,[[1,7]])};exports.deleteVideo=deleteVideo;
//# sourceMappingURL=videoController.min.js.map
